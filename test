local OrionLib = loadstring(game:HttpGet(('https://raw.githubusercontent.com/shlexware/Orion/main/source')))()

local Window = OrionLib:MakeWindow({Name = "Title of the library", HidePremium = false, SaveConfig = true, ConfigFolder = "OrionTest"})

local Tab = Window:MakeTab({
	Name = "Tab 1",
	Icon = "rbxassetid://4483345998",
	PremiumOnly = false
})

local Basket = game.Players.LocalPlayer
local fx = Basket.Character or Basket.CharacterAdded:Wait()
local fxHuman = fx:WaitForChild("Humanoid")
local fxRoot = fx:WaitForChild("HumanoidRootPart")
local BasketToolName = "Basketball"
local fxFollow = false
local gui

local function getBasketball()
    for _, tool in pairs(workspace:GetChildren()) do
        if tool:IsA("Tool") and tool.Name == BasketToolName then
            return tool
        end
    end
    return nil
end

local function fxPressF()
    game:GetService("VirtualInputManager"):SendKeyEvent(true, Enum.KeyCode.F, false, game)
end

local function fxReleaseF()
    game:GetService("VirtualInputManager"):SendKeyEvent(false, Enum.KeyCode.F, false, game)
end

local function fxHasTool(character)
    local fxTool = character:FindFirstChildOfClass("Tool")
    return fxTool and fxTool.Name == BasketToolName
end

local function fxFindNearestWithTool()
    local fxNearest, fxDist = nil, math.huge

    for _, fxPlayer in pairs(game.Players:GetPlayers()) do
        if fxPlayer ~= Basket and fxPlayer.Character and fxPlayer.Team ~= Basket.Team then
            local fxCh = fxPlayer.Character
            local fxHum = fxCh:FindFirstChild("Humanoid")
            local fxRootPart = fxCh:FindFirstChild("HumanoidRootPart")

            if fxHum and fxRootPart and fxHasTool(fxCh) then
                local fxDistance = (fxRoot.Position - fxRootPart.Position).Magnitude
                if fxDistance < fxDist and fxDistance <= 15 then  -- Only consider players within 15 units
                    fxNearest = fxPlayer
                    fxDist = fxDistance
                end
            end
        end
    end

    return fxNearest
end

local function fxFollowTarget(fxTarget)
    if fxTarget and fxTarget.Character then
        local fxTargetRootPart = fxTarget.Character:FindFirstChild("HumanoidRootPart")
        if fxTargetRootPart then
            fxHuman:MoveTo(fxTargetRootPart.Position + fxTargetRootPart.CFrame.LookVector * 5)
            fxPressF()
        end
    end
end

local function fxMoveToBall(ball)
    if ball and ball:IsDescendantOf(workspace) then
        local ballPosition = ball.Position
        local fxDistance = (fxRoot.Position - ballPosition).Magnitude
        if fxDistance > 15 then
            fxHuman:MoveTo(ballPosition)
        end
    end
end

local function fxNpcMove()
    while fxFollow do
        local ball = getBasketball()

        if ball and not ball.Parent:IsA("Player") then
            fxMoveToBall(ball)
        else
            local fxNearestPlayer = fxFindNearestWithTool()
            if fxNearestPlayer then
                fxFollowTarget(fxNearestPlayer)
            end
        end

        wait(0)
    end
end

local function createFollowButton()
    gui = Instance.new("ScreenGui", Basket:WaitForChild("PlayerGui"))
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(0, 200, 0, 50)
    button.Position = UDim2.new(0.5, -100, 0.5, -25)
    button.Text = "Auto Guard - ðŸ”´[Off]"
    button.Draggable = true
    button.BackgroundColor3 = Color3.fromRGB(255, 0, 0) -- Red
    button.Parent = gui

    button.MouseButton1Click:Connect(function()
        fxFollow = not fxFollow
        if fxFollow then
            button.Text = "Auto Guard - ðŸŸ¢[On]"
            button.BackgroundColor3 = Color3.fromRGB(0, 255, 0) -- Green
            fxNpcMove()
        else
            button.Text = "Auto Guard - ðŸ”´[Off]"
            button.BackgroundColor3 = Color3.fromRGB(255, 0, 0) -- Red
            fxReleaseF()
        end
    end)
end

local function destroyGui()
    if gui then
        gui:Destroy()
        gui = nil
    end
end

Tab:AddToggle({
    Name = "Auto Guard Mobile",
    Default = false,
    Callback = function(Value)
        fxFollow = Value
        if fxFollow then
            createFollowButton()
        else
            destroyGui()
        end
    end
})
